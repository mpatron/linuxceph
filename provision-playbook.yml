---
# Playbook to configure VM libvirt

- name: Playbook to configure VM libvirt
  hosts: all
  become: true

  roles:
    - role: ansible_role_libvirt_client_configure
    - role: geerlingguy.swap
      vars:
        swap_file_state: 'absent'

  tasks:
    - name: "== Vagrant provisionning == Printing Fact Variables for the cluster nodes"
      ansible.builtin.debug:
        msg: "The value of OS Family is {{ item.prop }} [ {{ item.value }} ]"
      with_items:
        - { prop: 'ansible_os_family', value: "{{ ansible_os_family }}" }
        - { prop: 'ansible_distribution', value: "{{ ansible_distribution }}" }
        - { prop: 'ansible_distribution_major_version', value: "{{ ansible_distribution_major_version }}" }
    - name: DÃ©finir le fuseau horaire sur Europe/Paris
      community.general.timezone:
        name: Europe/Paris
    - name: "== Vagrant provisionning == Install the latest version of podman"
      ansible.builtin.dnf:
        name:
          - vim
          # Ceph dependencies
          # - podman
          - chrony
          - lvm2
          - git
        state: present
        update_cache: true
      when: ansible_os_family == "RedHat"
